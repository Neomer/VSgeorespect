"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_get=function a(b,c,d){null===b&&(b=Function.prototype);var f=Object.getOwnPropertyDescriptor(b,c);if(f===void 0){var g=Object.getPrototypeOf(b);return null===g?void 0:a(g,c,d)}if("value"in f)return f.value;var h=f.get;return void 0===h?void 0:h.call(d)},_set=function a(b,c,d,f){var g=Object.getOwnPropertyDescriptor(b,c);if(g===void 0){var h=Object.getPrototypeOf(b);null!==h&&a(h,c,d,f)}else if("value"in g&&g.writable)g.value=d;else{var j=g.set;j!==void 0&&j.call(f,d)}return d},_createClass=function(){function a(b,c){for(var f,d=0;d<c.length;d++)f=c[d],f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(b,f.key,f)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"==typeof b||"function"==typeof b)?b:a}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var toolbar=null,IColor=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"String",get:function get(){throw"Not implemented!"}}]),a}(),RGBColor=function(a){function b(){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return c.color="000000",c}return _inherits(b,a),_createClass(b,[{key:"RGB",get:function get(){return this.color},set:function set(c){if(6==c.length)this.color=c;else throw"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u044B\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0446\u0432\u0435\u0442\u0430 "+c}},{key:"String",get:function get(){return"#"+this.color}}]),b}(IColor),RGBAColor=function(a){function b(){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return c.alpha="00",c}return _inherits(b,a),_createClass(b,[{key:"RGBA",get:function get(){return this.String},set:function set(c){if(6==c.length)_set(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"RGB",c,this),this.alpha="ff";else if(8==c.length)this.alpha=c.substring(0,2),_set(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"RGB",c.substring(2),this);else throw"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u044B\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0446\u0432\u0435\u0442\u0430 "+c}},{key:"Alpha",get:function get(){return this.alpha},set:function set(c){this.alpha=c}},{key:"AlphaFloat",get:function get(){return parseInt("0x"+this.alpha)/255}},{key:"String",get:function get(){return"#"+_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"RGB",this)+this.alpha}}]),b}(RGBColor),IBrush=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"getLineColor",value:function getLineColor(){throw"Not implemented!"}},{key:"getFillColor",value:function getFillColor(){throw"Not implemented!"}}]),a}(),Brush=function(a){function b(){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return c.lineColor=new RGBColor,c.fillColor=new RGBAColor,c.weight=1,c}return _inherits(b,a),_createClass(b,[{key:"LineColor",get:function get(){return this.lineColor}},{key:"FillColor",get:function get(){return this.fillColor}},{key:"Weight",get:function get(){return this.weight},set:function set(c){this.weight=c}}]),b}(IBrush),ICoordinates=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"fromString",value:function fromString(){throw"Not implemented!"}},{key:"Lat",get:function get(){throw"Not implemented!"}},{key:"Lng",get:function get(){throw"Not implemented!"}},{key:"String",get:function get(){throw"Not implemented!"}}]),a}(),YandexCoordinates=function(a){function b(c){_classCallCheck(this,b);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return d.coordinates=c,d}return _inherits(b,a),_createClass(b,[{key:"fromString",value:function fromString(){throw"Not implemented!"}},{key:"Coordinates",get:function get(){return this.coordinates}},{key:"Lat",get:function get(){return this.coordinates[0]}},{key:"Lng",get:function get(){return this.coordinates[1]}},{key:"String",get:function get(){throw"Not implemented!"}}]),b}(ICoordinates),GoogleCoordinates=function(a){function b(c){_classCallCheck(this,b);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return d.coordinates=c,d}return _inherits(b,a),_createClass(b,[{key:"fromString",value:function fromString(){throw"Not implemented!"}},{key:"Coordinates",get:function get(){return this.coordinates}},{key:"Lat",get:function get(){return this.coordinates.lat}},{key:"Lng",get:function get(){return this.coordinates.lng}},{key:"String",get:function get(){throw"Not implemented!"}}]),b}(ICoordinates),IObject=function(){function a(b){if(_classCallCheck(this,a),this.brush=null,Object.is(b,null)||Object.is(b,void 0))throw"Null object!";if("object"!=("undefined"==typeof b?"undefined":_typeof(b)))throw"Object has wrong type!";this.object=b,this.objectIndex=0}return _createClass(a,[{key:"AddVertex",value:function AddVertex(){throw"Not implemented!"}},{key:"SetParamaters",value:function SetParamaters(){throw"Not implemented!"}},{key:"SetObjectNumber",value:function SetObjectNumber(b){this.objectIndex=b}},{key:"Init",value:function Init(){throw"Not implemented!"}},{key:"Draw",value:function Draw(){throw"Not implemented!"}},{key:"Destroy",value:function Destroy(){throw"Not implemented!"}},{key:"Edit",value:function Edit(){throw"Not implemented!"}},{key:"StopEditing",value:function StopEditing(){throw"Not implemented!"}},{key:"Brush",set:function set(b){this.brush=b},get:function get(){return this.brush}},{key:"Object",get:function get(){return this.object}},{key:"IsValid",get:function get(){throw"Not implemented!"}},{key:"MaxVerticies",get:function get(){throw"Not implemented!"}},{key:"VerticiesCount",get:function get(){throw"Not implemented!"}},{key:"ObjectNumber",get:function get(){return this.objectIndex}}]),a}(),ICompositeObject=function(a){function b(c){_classCallCheck(this,b);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c));return d.coordinates=[],d}return _inherits(b,a),_createClass(b,[{key:"Coordinates",get:function get(){return this.coordinates}},{key:"IsValid",get:function get(){1<this.coordinates.length}}]),b}(IObject),ClosedCompositeObject=function(a){function b(c){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c))}return _inherits(b,a),_createClass(b,[{key:"AddVertex",value:function AddVertex(c){this.VerticiesCount<this.MaxVerticies?this.coordinates.slice(this.VerticiesCount,0,c):this.coordinates[this.VerticiesCount-1]=c}},{key:"VerticiesCount",get:function get(){return 0==this.Coordinates.length?0:this.Coordinates.length+1}}]),b}(ICompositeObject),NonClosedCompositeObject=function(a){function b(c){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c))}return _inherits(b,a),_createClass(b,[{key:"AddVertex",value:function AddVertex(c){this.VerticiesCount<this.MaxVerticies?this.coordinates.push(c):this.coordinates[this.VerticiesCount-1]=c}},{key:"VerticiesCount",get:function get(){return this.Coordinates.length}}]),b}(ICompositeObject),IPolyline=function(a){function b(c){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c))}return _inherits(b,a),b}(NonClosedCompositeObject),Polyline=function(a){function b(c){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c))}return _inherits(b,a),_createClass(b,[{key:"Draw",value:function Draw(){}},{key:"MaxVerticies",get:function get(){return 15}}]),b}(IPolyline),YandexPolyline=function(a){function b(c){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c))}return _inherits(b,a),_createClass(b,[{key:"Init",value:function Init(){}},{key:"AddVertex",value:function AddVertex(c){var d=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).geometry;d.insert(d.getLength(),c.Coordinates)}},{key:"Draw",value:function Draw(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).options.set({strokeColor:_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Brush",this).LineColor.String,strokeWidth:_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Brush",this).Weight}),_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).editor.startEditing()}},{key:"Edit",value:function Edit(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).editor.startEditing()}},{key:"StopEditing",value:function StopEditing(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).editor.stopEditing()}},{key:"Destroy",value:function Destroy(){}}]),b}(Polyline),GooglePolyline=function(a){function b(c){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c))}return _inherits(b,a),_createClass(b,[{key:"Init",value:function Init(){}},{key:"AddVertex",value:function AddVertex(c){var d=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).getPath();d.push(c.Coordinates)}},{key:"Draw",value:function Draw(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).setOptions({strokeColor:_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Brush",this).LineColor.String,strokeWeight:_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Brush",this).Weight}),_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).setEditable(!0)}},{key:"Edit",value:function Edit(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).setEditable(!0)}},{key:"StopEditing",value:function StopEditing(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).setEditable(!1)}},{key:"Destroy",value:function Destroy(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).setMap(null)}}]),b}(Polyline),IPolygon=function(a){function b(c){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c))}return _inherits(b,a),b}(ClosedCompositeObject),Polygon=function(a){function b(c){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c))}return _inherits(b,a),_createClass(b,[{key:"Draw",value:function Draw(){}},{key:"MaxVerticies",get:function get(){return 15}}]),b}(IPolygon),YandexPolygon=function(a){function b(c){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c))}return _inherits(b,a),_createClass(b,[{key:"Init",value:function Init(){}},{key:"AddVertex",value:function AddVertex(c){var d=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).geometry,f=d.get(0);(null==f||void 0==f)&&(f=[]),0<f.length?f.splice(f.length-1,0,c.Coordinates):f.push(c.Coordinates),d.set(0,f)}},{key:"Draw",value:function Draw(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).options.set({strokeColor:_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Brush",this).LineColor.String,strokeWidth:_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Brush",this).Weight,fillColor:_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Brush",this).FillColor.String}),this.Edit()}},{key:"Edit",value:function Edit(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).editor.startEditing()}},{key:"StopEditing",value:function StopEditing(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).editor.stopEditing()}},{key:"Destroy",value:function Destroy(){}}]),b}(Polygon),GooglePolygon=function(a){function b(c){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c))}return _inherits(b,a),_createClass(b,[{key:"Init",value:function Init(){}},{key:"AddVertex",value:function AddVertex(c){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).getPaths().getAt(0).push(c.Coordinates)}},{key:"Draw",value:function Draw(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).setOptions({strokeColor:_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Brush",this).LineColor.String,strokeWeight:_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Brush",this).Weight,fillOpacity:_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Brush",this).FillColor.AlphaFloat,fillColor:_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Brush",this).FillColor.String}),_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).setEditable(!0)}},{key:"Edit",value:function Edit(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).setEditable(!0)}},{key:"StopEditing",value:function StopEditing(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).setEditable(!1)}},{key:"Destroy",value:function Destroy(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).setMap(null)}}]),b}(Polygon),ILine=function(a){function b(c){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c))}return _inherits(b,a),b}(NonClosedCompositeObject),Line=function(a){function b(c){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c))}return _inherits(b,a),_createClass(b,[{key:"Init",value:function Init(){}},{key:"MaxVerticies",get:function get(){return 2}}]),b}(ILine),YandexLine=function(a){function b(c){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c))}return _inherits(b,a),_createClass(b,[{key:"AddVertex",value:function AddVertex(c){var d=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).geometry;d.getLength()<_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"MaxVerticies",this)?d.insert(d.getLength(),c.Coordinates):d.set(d.getLength()-1,c.Coordinates)}},{key:"Draw",value:function Draw(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).options.set({strokeColor:_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Brush",this).LineColor.String,strokeWidth:_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Brush",this).Weight}),_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).editor.startEditing()}},{key:"Edit",value:function Edit(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).editor.startEditing()}},{key:"StopEditing",value:function StopEditing(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).editor.stopEditing()}},{key:"Destroy",value:function Destroy(){}}]),b}(Line),GoogleLine=function(a){function b(c){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c))}return _inherits(b,a),_createClass(b,[{key:"AddVertex",value:function AddVertex(c){var d=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).getPath();d.length<_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"MaxVerticies",this)?d.push(c.Coordinates):d.setAt(d.length-1,c.Coordinates)}},{key:"Draw",value:function Draw(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).setOptions({strokeColor:_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Brush",this).LineColor.String,strokeWeight:_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Brush",this).Weight}),_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).setEditable(!0)}},{key:"Edit",value:function Edit(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).setEditable(!0)}},{key:"StopEditing",value:function StopEditing(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).setEditable(!1)}},{key:"Destroy",value:function Destroy(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).setMap(null)}}]),b}(Line),IInfo=function(a){function b(c){_classCallCheck(this,b);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c));return d.coordinates=null,d.text="",d}return _inherits(b,a),_createClass(b,[{key:"Coordinates",get:function get(){return this.coordinates}},{key:"Text",get:function get(){return this.text},set:function set(c){this.text=c,this.Draw()}}]),b}(IObject),Info=function(a){function b(c){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c))}return _inherits(b,a),_createClass(b,[{key:"Draw",value:function Draw(){(null==_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Text",this)||void 0==_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Text",this)||""==_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Text",this))&&$("#infoMessageDialog").dialog("open")}},{key:"AddVertex",value:function AddVertex(c){this.VerticiesCount<this.MaxVerticies?this.coordinates.push(c):this.coordinates[this.VerticiesCount-1]=c}},{key:"MaxVerticies",get:function get(){return null==this.coordinates?0:1}}]),b}(IInfo),GoogleInfo=function(a){function b(c){_classCallCheck(this,b);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c));return c.setContent("test message"),c.open(),d}return _inherits(b,a),_createClass(b,[{key:"Init",value:function Init(){}},{key:"AddVertex",value:function AddVertex(c){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).setPosition(c.Coordinates),_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).setOptions({label:_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"ObjectNumber",this).toString()})}},{key:"Draw",value:function Draw(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Draw",this).call(this),_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).setContent(_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Text",this))}},{key:"Edit",value:function Edit(){}},{key:"StopEditing",value:function StopEditing(){}},{key:"Destroy",value:function Destroy(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).setMap(null)}}]),b}(Info),YandexInfo=function(a){function b(c){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c))}return _inherits(b,a),_createClass(b,[{key:"Init",value:function Init(){}},{key:"AddVertex",value:function AddVertex(c){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).geometry.setCoordinates(c.Coordinates)}},{key:"Draw",value:function Draw(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Draw",this).call(this),_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).balloon.setData(_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Text",this)),_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Object",this).balloon.open()}},{key:"Edit",value:function Edit(){}},{key:"StopEditing",value:function StopEditing(){}},{key:"Destroy",value:function Destroy(){}}]),b}(Info),IObjectFactory=function(){function a(b){_classCallCheck(this,a),this.map=b}return _createClass(a,[{key:"CreateObject",value:function CreateObject(){throw"Not implemented!"}},{key:"Map",get:function get(){return this.map}}]),a}();var YandexObjectFactory=function(a){function b(c){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c))}return _inherits(b,a),_createClass(b,[{key:"CreateObject",value:function CreateObject(c){return"message"===c?new YandexInfo(new ymaps.Placemark([])):"line"===c?new YandexLine(new ymaps.Polyline([])):"polyline"===c?new YandexPolyline(new ymaps.Polyline([])):"polygon"===c?new YandexPolygon(new ymaps.Polygon([[]])):null}}]),b}(IObjectFactory),GoogleObjectFactory=function(a){function b(c){_classCallCheck(this,b);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c));return d.objIndexes={},d}return _inherits(b,a),_createClass(b,[{key:"CreateObject",value:function CreateObject(c){var d=null,f=null==this.objIndexes[c]||void 0==this.objIndexes[c]?1:this.objIndexes[c]+1;switch(c){case"message":d=new GoogleInfo(new google.maps.InfoWindow());break;case"line":d=new GoogleLine(new google.maps.Polyline());break;case"polyline":d=new GooglePolyline(new google.maps.Polyline());break;case"polygon":d=new GooglePolygon(new google.maps.Polygon());break;default:return null;}return null!=d&&void 0!=d&&(d.SetObjectNumber(f),this.objIndexes[c]=f),d}}]),b}(IObjectFactory),IGeoCoder=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"Find",value:function Find(){throw"Not implemented!"}}]),a}(),GeoCoderResultCollection=function(){function a(){_classCallCheck(this,a),this.array=[]}return _createClass(a,[{key:"push",value:function push(b){this.array.push(b)}},{key:"Count",get:function get(){return this.array.length}},{key:"AddressList",get:function get(){var b=[];return this.array.forEach(function(c){b.push(c.Address)}),b}},{key:"AutocompleteData",get:function get(){var b=[];return this.array.forEach(function(c){b.push({label:c.Address,value:c.Address,longlat:c.Coordinates})}),b}}]),a}(),GeoCoderResult=function(){function a(b,c){_classCallCheck(this,a),this.address=b,this.coordinates=c}return _createClass(a,[{key:"Address",get:function get(){return this.address}},{key:"Coordinates",get:function get(){return this.coordinates}}]),a}(),GoogleGeoCoder=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:"Find",value:function Find(){return null}}]),b}(IGeoCoder),YandexGeoCoder=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this))}return _inherits(b,a),_createClass(b,[{key:"Find",value:function Find(c,d){var f=ymaps.geocode(c,{json:!0}),g=new GeoCoderResultCollection;f.then(function(h){h.GeoObjectCollection.featureMember.forEach(function(j){g.push(new GeoCoderResult(j.GeoObject.name,new YandexCoordinates(j.GeoObject.Point.pos)))}),console.log(h),d(g)},function(h){console.log(h)})}}]),b}(IGeoCoder),IMap=function(){function a(b){_classCallCheck(this,a),this.divName=b,this.divElement=$(b),this.selectedBrush=new Brush,this.selectedObject=null,this.isInit=!1,this.objects=[],this.geocoder=null,this.factory=null}return _createClass(a,[{key:"Init",value:function Init(){this.isInit=!0,this.ActiveBrush.LineColor.RGB="880000",this.ActiveBrush.FillColor.RGB="880000",this.ActiveBrush.FillColor.Alpha="88",this.ActiveBrush.Weight=1}},{key:"Load",value:function Load(){for(var b=0;b<this.objects.length;b++)this.objects[b].Draw()}},{key:"Unload",value:function Unload(){throw"Not implemented!"}},{key:"SelectObject",value:function SelectObject(b){this.selectedObject=b,this.objects.forEach(function(d){d.StopEditing()}),null!=b&&void 0!=b&&b.Edit();var c=this;$(document).on("keyup",function(d){46==d.keyCode?(null!=c.SelectedObject&&void 0!=c.SelectedObject&&c.SelectedObject.Destroy(),toolbar.flush(),c.EndDrawing()):27==d.keyCode&&(toolbar.flush(),c.EndDrawing())})}},{key:"CreateObject",value:function CreateObject(b){if(Object.is(b,null)||Object.is(b,void 0))throw"Null reference exception!";b.Init(),this.objects.push(b),this.SelectObject(b),b.Brush=this.selectedBrush}},{key:"BeginDrawing",value:function BeginDrawing(){throw"Not implemented!"}},{key:"EndDrawing",value:function EndDrawing(){this.SelectObject(null)}},{key:"ActiveBrush",get:function get(){return this.selectedBrush}},{key:"ObjectFactory",get:function get(){return this.factory}},{key:"MapElement",get:function get(){return this.divElement}},{key:"ElementName",get:function get(){return this.divName}},{key:"IsInit",get:function get(){return this.isInit}},{key:"GeoCoder",get:function get(){return this.geocoder}},{key:"SelectedObject",get:function get(){return this.selectedObject}}]),a}();var GoogleMap=function(a){function b(c){_classCallCheck(this,b);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c));return d.instance=null,d.clickListener=null,d}return _inherits(b,a),_createClass(b,[{key:"Init",value:function Init(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Init",this).call(this),this.geocoder=new GoogleGeoCoder,this.factory=new GoogleObjectFactory(this,this.instance)}},{key:"Load",value:function Load(){if(!_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"IsInit",this))throw"\u041A\u0430\u0440\u0442\u044B \u043D\u0435 \u0431\u044B\u043B\u0438 \u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0438\u0440\u043E\u0432\u0430\u043D\u044B!";this.instance=new google.maps.Map(document.getElementById("map"),{zoom:16,center:{lat:56.852379,lng:53.202749},disableDoubleClickZoom:!1,fullscreenControl:!1,minZoom:16,maxZoom:18,scrollwheel:!1,scaleControl:!1,rotateControl:!1}),this.instance.setOptions({draggableCursor:"arrow"}),_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Load",this).call(this)}},{key:"Unload",value:function Unload(){}},{key:"CreateObject",value:function CreateObject(c){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"CreateObject",this).call(this,c);var d=this;c.Object.addListener("click",function(){d.SelectObject(c)})}},{key:"BeginDrawing",value:function BeginDrawing(c){this.EndDrawing();var d=this.instance,f=this;{var g=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"ObjectFactory",this).CreateObject(c);null!=g&&void 0!=g&&(this.CreateObject(g),g.Object.setMap(d),this.clickListener=d.addListener("click",function(h){var j=new GoogleCoordinates(h.latLng);null!=f.SelectedObject&&void 0!=f.SelectedObject&&(f.SelectedObject.AddVertex(j),f.SelectedObject.Draw())}),d.setOptions({draggableCursor:"crosshair"}))}}},{key:"EndDrawing",value:function EndDrawing(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"EndDrawing",this).call(this),null!=this.clickListener&&void 0!=this.clickListener&&this.clickListener.remove(),this.instance.setOptions({draggableCursor:"arrow"}),$(document).off("keyup")}}]),b}(IMap),YandexMap=function(a){function b(c){_classCallCheck(this,b);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c));return d.instance=null,d}return _inherits(b,a),_createClass(b,[{key:"Init",value:function Init(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Init",this).call(this),this.geocoder=new YandexGeoCoder,this.factory=new YandexObjectFactory(this,this.instance)}},{key:"Load",value:function Load(){if(!_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"IsInit",this))throw"\u041A\u0430\u0440\u0442\u044B \u043D\u0435 \u0431\u044B\u043B\u0438 \u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0438\u0440\u043E\u0432\u0430\u043D\u044B!";this.instance=new ymaps.Map(this.ElementName,{center:[56.852379,53.202749],zoom:16,minZoom:16,avoidFractionalZoom:!1}),this.cursor=this.instance.cursors.push("arrow"),this.instance.behaviors.disable("scrollZoom").disable("dblClickZoom").disable("rightMouseButtonMagnifier").disable("leftMouseButtonMagnifier").disable("ruler").disable("routeEditor"),this.instance.controls.remove("fullscreenControl").remove("routeEditor").remove("rulerControl").remove("searchControl").remove("trafficControl").remove("zoomControl"),_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Load",this).call(this)}},{key:"Unload",value:function Unload(){null==this.instance||void 0==this.instance||this.instance.destroy()}},{key:"SetZoom",value:function SetZoom(c){this.instance.setZoom(c)}},{key:"CreateObject",value:function CreateObject(c){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"CreateObject",this).call(this,c),c.Object.events.add("click",function(){map.SelectObject(c)}),this.instance.geoObjects.add(c.Object)}},{key:"BeginDrawing",value:function BeginDrawing(c){this.EndDrawing();var d=this.instance,f=this;{var g=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"ObjectFactory",this).CreateObject(c);null!=g&&void 0!=g&&(this.CreateObject(g),d.events.add("click",function(h){var j=new YandexCoordinates(h.get("coords"));f.SelectedObject.AddVertex(j),f.SelectedObject.Draw()}),this.cursor.setKey("crosshair"))}}},{key:"EndDrawing",value:function EndDrawing(){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"EndDrawing",this).call(this),this.cursor.setKey("arrow"),this.instance.events.remove("click"),$(document).off("keyup")}}]),b}(IMap),MapProvider=function(){function a(){_classCallCheck(this,a),this.maps={},this.active=null}return _createClass(a,[{key:"Add",value:function Add(b,c){this.maps[b]=c}},{key:"Get",value:function Get(b){return this.maps[b]}},{key:"Select",value:function Select(b){var c=this.maps;Object.keys(this.maps).forEach(function(d){c[d].Unload()}),this.active=this.maps[b],this.active.Load()}},{key:"GetAll",value:function GetAll(){return Object.values(this.maps)}},{key:"ActiveMap",get:function get(){if(null==this.active||void 0==this.active)throw"\u041D\u0435\u0442 \u0430\u043A\u0442\u0438\u0432\u043D\u043E\u0439 \u043A\u0430\u0440\u0442\u044B!";return this.active}}]),a}(),mapProvider=new MapProvider;mapProvider.Add("google",new GoogleMap("map"));function InitGoogleMap(){mapProvider.Get("google").Init(),mapProvider.Select("google")}$(function(){(function(a){a.fn.toolbar=function(b){var c=a.extend({controls:[],selected:function selected(){}},b),d=a(this);return this.flush=function(){a(this).find(".toolbar-button-selected").removeClass("toolbar-button-selected")},this.each(function(){d.addClass("toolbar"),c.controls.forEach(function(f){var g=document.createElement("div");null!=f.image&&void 0!=f.image&&a(g).html("<img src=\"Content/Images/"+f.image+"\" />"),a(g).html(a(g).html()+" "+f.title),a(g).addClass("toolbar-button"),a(g).attr("command",f.command),null!=f.tooltip&&void 0!=f.tooltip&&""!=f.tooltip&&a(g).attr("title",f.tooltip),a(g).click(function(){var j=a(this).parent().find(".toolbar-button-selected").attr("command");a(this).hasClass("toolbar-button-selected")?(a(this).removeClass("toolbar-button-selected"),c.selected(null,j)):(a(this).parent().find(".toolbar-button").removeClass("toolbar-button-selected"),a(this).addClass("toolbar-button-selected"),c.selected(a(this).attr("command"),j))}),d.append(g)})})}})(jQuery),toolbar=$("#toolbar").toolbar({controls:[{title:"\u0421\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0435",command:"message",image:"x16/speech-bubble.png"},{title:"\u041E\u0442\u0440\u0435\u0437\u043E\u043A",command:"line",image:"x16/line.png",tooltip:"\u041F\u0440\u043E\u0441\u0442\u0430\u044F \u043B\u0438\u043D\u0438\u044F"},{title:"\u041B\u043E\u043C\u0430\u043D\u043D\u0430\u044F",command:"polyline",image:"x16/polyline.png",tooltip:"\u041B\u043E\u043C\u0430\u043D\u043D\u0430\u044F \u043B\u0438\u043D\u0438\u044F"},{title:"\u041F\u043E\u043B\u0438\u0433\u043E\u043D",command:"polygon",image:"x16/hexagon.png",tooltip:"\u0417\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u043D\u0430\u044F \u0446\u0432\u0435\u0442\u043E\u043C \u043E\u0431\u043B\u0430\u0441\u0442\u044C"}],selected:function selected(a){null!=a&&a!=void 0?mapProvider.ActiveMap.BeginDrawing(a):mapProvider.ActiveMap.EndDrawing()}}),$("#service_toolbar").toolbar({controls:[{title:"Google Maps",command:"google",image:"x16/google.png"}],selected:function selected(a){toolbar.flush(),mapProvider.Select(a)}}),$("#lineColorPicker").spectrum({flat:!1,showAlpha:!1,showPalette:!0,cancelText:"\u041E\u0442\u043C\u0435\u043D\u0430",chooseText:"\u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C",color:"#880000",maxSelectionSize:4,showButtons:!1,move:function move(a){console.log("Color pick: "+a.toHexString().substring(1)),mapProvider.GetAll().forEach(function(b){b.ActiveBrush.LineColor.RGB=a.toHexString().substring(1),b.SelectedObject!=void 0&&null!=b.SelectedObject&&b.SelectedObject.Draw()})}}),$("#fillColorPicker").spectrum({flat:!1,showAlpha:!0,showPalette:!0,cancelText:"\u041E\u0442\u043C\u0435\u043D\u0430",chooseText:"\u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C",color:"#88880000",maxSelectionSize:4,showButtons:!1,move:function move(a){mapProvider.GetAll().forEach(function(b){b.ActiveBrush.FillColor.RGBA=a.toHex8String().substring(1),b.SelectedObject!=void 0&&null!=b.SelectedObject&&b.SelectedObject.Draw()})}}),$("#lineWeight").on("change",function(){var b=this.value;mapProvider.GetAll().forEach(function(c){c.ActiveBrush.Weight=b,c.SelectedObject!=void 0&&null!=c.SelectedObject&&c.SelectedObject.Draw()})}),$("#infoMessageDialog").dialog({width:"400px",height:"auto",resizable:!1,modal:!0,buttons:{Применить:function _(){$(this).dialog("close"),mapProvider.ActiveMap.SelectedObject.Text=$(this).find("input[type=text]").val(),console.log(mapProvider.ActiveMap.SelectedObject.Text)},Отмена:function _(){$(this).dialog("close")}}}),$("#infoMessageDialog").dialog("close")}),ymaps.ready(function(){var a=mapProvider.Get("yandex");null!=a&&a!=void 0&&a.Init()});